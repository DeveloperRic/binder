<div id="dashboardStage" class="stage">
  <div class="mainPane" ng-click="onMainPaneClick()">
    <div class="labelStrip">
      <div class="label">
        <div class="label-text">
          <div class="pages">
            <a class="page" ng-click="openFolder('all', 'root')">Files</a>
            <a class="page" ng-repeat="page in pageStack" ng-click="onFileClick(page)"> / {{page.dat.name}}</a>
          </div>
          <div class="invisible label-floor"></div>
        </div>
        <img ng-show="currentFolderSource=='gdrive'" src="../css/img/google_drive_lockup.png">
        <img ng-show="currentFolderSource=='onedrive'" src="../css/img/onedrive_lockup.png">
      </div>
      <div class="sorting label" ng-if="currentFolderSource && currentFolder">
        <div class="label-text inline">
          Order by
          <div class="sort-criteria" ng-click="sorting.toggleDrawer($event)">
            <div class="inline">
              <span class="criteria" ng-repeat="criteria in sorting.orderBy">
                <span ng-if="!$first">, </span>
                {{criteria.text}}
              </span>
              <span class="text-color-muted" ng-if="sorting.orderBy.length == 0">&lt; no order &gt;</span>
              <span class="criteria">▼</span>
            </div>
            <div class="label-floor"></div>
          </div>
        </div>
        <div class="sort-list background-secondary drop-shadow" ng-show="sorting.drawerOpen">
          <div class="criteria" ng-repeat="criteria in sorting.availableMethods" ng-if="currentFolderSource == 'all' || criteria['all'] || criteria[currentFolderSource]"
            ng-click="sorting.onCriteriaClick(criteria)">
            <div class="criteria-rank background-primary" ng-if="criteria.enabled">
              <div class="criteria-rank-item">{{sorting.orderBy.indexOf(criteria) + 1}}</div>
              <div class="criteria-rank-item" ng-if="criteria.descending">↧</div>
              <div class="criteria-rank-item" ng-if="!criteria.descending">↥</div>
            </div>
            {{criteria.text}}
          </div>
        </div>
      </div>
    </div>
    <div class="file-tray">
      <div class="tile background-secondary drop-shadow-light" ng-repeat="file in files" ng-click="onFileClick(file)" context-menu="fileContextMenu(file)">
        <div class="tile-top">
          <img ng-show="!file.isFolder" src="{{file.dat.iconLink}}" />
          <i class="material-icons" ng-show="file.isFolder">folder</i>
        </div>
        <div class="tile-content">
          <span class="tile-text">{{file.dat.name}}</span>
        </div>
        <div class="tile-bottom">
          <img src="../css/img/google_drive_icon_small_20.png" ng-show="file.source=='gdrive'">
          <img src="../css/img/onedrive_lockup.png" ng-show="file.source=='onedrive'">
        </div>
      </div>
    </div>
  </div>
  <div id="fileDetailsPane" class="ng-hide background-secondary">
    <div class="file-thumbnail background-secondary-light">
      <div class="file-thumbnail-text" ng-show="detailsFile.source == 'gdrive' && user.drive.scopeLevel == 0">
        <span class="text-muted">File thumbnails require extended permissions</span>
        <br/>
        <a class="file-thumbnail-text-link text-color-accent" ng-click="extendGDriveScope()">Click here to give Binder more access</a>
      </div>
      <div class="file-thumbnail-text" ng-show="user.drive.scopeLevel != 0 && !detailsFile.thumbnailLink">
        <span class="text-muted">This file doesn't have a thumbnail associated.</span>
      </div>
      <img src="{{detailsFile.thumbnailLink}}" alt="{{detailsFile.thumbnailLinkAlt}}" ng-show="detailsFile.thumbnailLink" />
    </div>
    <div class="file-info">
      <div>
        <div class="file-info-head">
          <span class="file-info-title" ng-click="openFile(detailsFile, true)">{{detailsFile.dat.name}}</span>
          <div class="file-info-starred" ng-click="toggleFileStarred(detailsFile)" ng-show="detailsFile.source=='gdrive'">
            <i class="material-icons" ng-show="detailsFile.dat.starred" ng-click="toggleStarred(false)">star</i>
            <i class="material-icons" ng-show="!detailsFile.dat.starred" ng-click="toggleStarred(true)">star_border</i>
          </div>
        </div>
        <h4>{{detailsFile.dat.description}}</h4>
        <span class="version text-muted" ng-show="detailsFile.versionNumber && detailsFile.dat.version != 0">Version: {{detailsFile.versionNumber}}</span>
      </div>
      <div class="file-info-audio background-secondary-light" ng-if="detailsFile.dat.audio">
        <audio id="fileInfoAudio" preload="none" controls>
          <source data-ng-src="{{detailsFile.streamURL}}">
        </audio>
      </div>
      <div class="file-info-properties">
        Size: {{formatFileSize(detailsFile.dat.size)}}
        <div class="modified" ng-show="detailsFile.versionNumber">
          <span class="modified-time">Modified: {{formatFileModifiedTime(detailsFile.lastModified)}}</span>
          <span class="modified-by text-muted"> by: {{detailsFile.lastModifiedBy}}</span>
        </div>
      </div>
    </div>
  </div>
</div>